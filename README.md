# Автоматизированная настройка Slurm-кластера

## Создание виртуальных машин через terraform

1. В папке terraform создаем файл terraform.tfvars, куда записываем domain_id, tenant_id, user_name, password, region для подключения к облаку.
2. В терминале из папки terraform запускаем команду `` terraform init``, смотрим, чтобы не было ошибок.
3. В терминале запускаем команду `` terraform plan ``, смотрим, чтобы не было ошибок.
4. В терминале запускаем `` terraform apply `` , вводим yes и ждем, когда в облаке создадутся виртуальные машины.

## Настройка Slurm-кластера на виртуальных машинах

1. В папке ansible в файле inventory.ini указываем адреса виртуальных машин с пометками slurm-controller или slurm-compute.
2. В терминале запускаем команду
   ``
    ansible-playbook -i inventory.ini slurm_cluster_setup.yml
   ``
## Проверка работы Slurm-кластера на виртуальных машинах

1. По ssh подключаемся к виртуальным машинам.
2. На контроллере вводим команды `` systemctl status slurmctld ``, `` sinfo ``. Команды должны пройти без ошибок, в статусе active.
3. На контроллере вводим команду `` srun -N1 -n1 hostname ``. Команда должна вывести имя одного узла.
4. На compute вводим команды `` systemctl status slurmd ``, `` sinfo ``. Команды должны пройти без ошибок, в статусе active.
